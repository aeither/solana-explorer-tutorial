{"ast":null,"code":"import { __rest, __assign } from 'tslib';\nimport { findSpring, calcAngularFreq } from '../utils/find-spring.js';\nvar durationKeys = [\"duration\", \"bounce\"];\nvar physicsKeys = [\"stiffness\", \"damping\", \"mass\"];\n\nfunction isSpringType(options, keys) {\n  return keys.some(function (key) {\n    return options[key] !== undefined;\n  });\n}\n\nfunction getSpringOptions(options) {\n  var springOptions = __assign({\n    velocity: 0.0,\n    stiffness: 100,\n    damping: 10,\n    mass: 1.0,\n    isResolvedFromDuration: false\n  }, options);\n\n  if (!isSpringType(options, physicsKeys) && isSpringType(options, durationKeys)) {\n    var derived = findSpring(options);\n    springOptions = __assign(__assign(__assign({}, springOptions), derived), {\n      velocity: 0.0,\n      mass: 1.0\n    });\n    springOptions.isResolvedFromDuration = true;\n  }\n\n  return springOptions;\n}\n\nfunction spring(_a) {\n  var _b = _a.from,\n      from = _b === void 0 ? 0.0 : _b,\n      _c = _a.to,\n      to = _c === void 0 ? 1.0 : _c,\n      _d = _a.restSpeed,\n      restSpeed = _d === void 0 ? 2 : _d,\n      restDelta = _a.restDelta,\n      options = __rest(_a, [\"from\", \"to\", \"restSpeed\", \"restDelta\"]);\n\n  var state = {\n    done: false,\n    value: from\n  };\n\n  var _e = getSpringOptions(options),\n      stiffness = _e.stiffness,\n      damping = _e.damping,\n      mass = _e.mass,\n      velocity = _e.velocity,\n      duration = _e.duration,\n      isResolvedFromDuration = _e.isResolvedFromDuration;\n\n  var resolveSpring = zero;\n  var resolveVelocity = zero;\n\n  function createSpring() {\n    var initialVelocity = velocity ? -(velocity / 1000) : 0.0;\n    var initialDelta = to - from;\n    var dampingRatio = damping / (2 * Math.sqrt(stiffness * mass));\n    var undampedAngularFreq = Math.sqrt(stiffness / mass) / 1000;\n    restDelta !== null && restDelta !== void 0 ? restDelta : restDelta = Math.abs(to - from) <= 1 ? 0.01 : 0.4;\n\n    if (dampingRatio < 1) {\n      var angularFreq_1 = calcAngularFreq(undampedAngularFreq, dampingRatio);\n\n      resolveSpring = function resolveSpring(t) {\n        var envelope = Math.exp(-dampingRatio * undampedAngularFreq * t);\n        return to - envelope * ((initialVelocity + dampingRatio * undampedAngularFreq * initialDelta) / angularFreq_1 * Math.sin(angularFreq_1 * t) + initialDelta * Math.cos(angularFreq_1 * t));\n      };\n\n      resolveVelocity = function resolveVelocity(t) {\n        var envelope = Math.exp(-dampingRatio * undampedAngularFreq * t);\n        return dampingRatio * undampedAngularFreq * envelope * (Math.sin(angularFreq_1 * t) * (initialVelocity + dampingRatio * undampedAngularFreq * initialDelta) / angularFreq_1 + initialDelta * Math.cos(angularFreq_1 * t)) - envelope * (Math.cos(angularFreq_1 * t) * (initialVelocity + dampingRatio * undampedAngularFreq * initialDelta) - angularFreq_1 * initialDelta * Math.sin(angularFreq_1 * t));\n      };\n    } else if (dampingRatio === 1) {\n      resolveSpring = function resolveSpring(t) {\n        return to - Math.exp(-undampedAngularFreq * t) * (initialDelta + (initialVelocity + undampedAngularFreq * initialDelta) * t);\n      };\n    } else {\n      var dampedAngularFreq_1 = undampedAngularFreq * Math.sqrt(dampingRatio * dampingRatio - 1);\n\n      resolveSpring = function resolveSpring(t) {\n        var envelope = Math.exp(-dampingRatio * undampedAngularFreq * t);\n        var freqForT = Math.min(dampedAngularFreq_1 * t, 300);\n        return to - envelope * ((initialVelocity + dampingRatio * undampedAngularFreq * initialDelta) * Math.sinh(freqForT) + dampedAngularFreq_1 * initialDelta * Math.cosh(freqForT)) / dampedAngularFreq_1;\n      };\n    }\n  }\n\n  createSpring();\n  return {\n    next: function next(t) {\n      var current = resolveSpring(t);\n\n      if (!isResolvedFromDuration) {\n        var currentVelocity = resolveVelocity(t) * 1000;\n        var isBelowVelocityThreshold = Math.abs(currentVelocity) <= restSpeed;\n        var isBelowDisplacementThreshold = Math.abs(to - current) <= restDelta;\n        state.done = isBelowVelocityThreshold && isBelowDisplacementThreshold;\n      } else {\n        state.done = t >= duration;\n      }\n\n      state.value = state.done ? to : current;\n      return state;\n    },\n    flipTarget: function flipTarget() {\n      var _a;\n\n      velocity = -velocity;\n      _a = [to, from], from = _a[0], to = _a[1];\n      createSpring();\n    }\n  };\n}\n\nspring.needsInterpolation = function (a, b) {\n  return typeof a === \"string\" || typeof b === \"string\";\n};\n\nvar zero = function zero(_t) {\n  return 0;\n};\n\nexport { spring };","map":{"version":3,"sources":["/Users/lin/Documents/Projects/solana-explorer-tutorial/node_modules/popmotion/dist/es/animations/generators/spring.js"],"names":["__rest","__assign","findSpring","calcAngularFreq","durationKeys","physicsKeys","isSpringType","options","keys","some","key","undefined","getSpringOptions","springOptions","velocity","stiffness","damping","mass","isResolvedFromDuration","derived","spring","_a","_b","from","_c","to","_d","restSpeed","restDelta","state","done","value","_e","duration","resolveSpring","zero","resolveVelocity","createSpring","initialVelocity","initialDelta","dampingRatio","Math","sqrt","undampedAngularFreq","abs","angularFreq_1","t","envelope","exp","sin","cos","dampedAngularFreq_1","freqForT","min","sinh","cosh","next","current","currentVelocity","isBelowVelocityThreshold","isBelowDisplacementThreshold","flipTarget","needsInterpolation","a","b","_t"],"mappings":"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","sourcesContent":["import { __rest, __assign } from 'tslib';\nimport { findSpring, calcAngularFreq } from '../utils/find-spring.js';\n\nvar durationKeys = [\"duration\", \"bounce\"];\nvar physicsKeys = [\"stiffness\", \"damping\", \"mass\"];\nfunction isSpringType(options, keys) {\n    return keys.some(function (key) { return options[key] !== undefined; });\n}\nfunction getSpringOptions(options) {\n    var springOptions = __assign({ velocity: 0.0, stiffness: 100, damping: 10, mass: 1.0, isResolvedFromDuration: false }, options);\n    if (!isSpringType(options, physicsKeys) &&\n        isSpringType(options, durationKeys)) {\n        var derived = findSpring(options);\n        springOptions = __assign(__assign(__assign({}, springOptions), derived), { velocity: 0.0, mass: 1.0 });\n        springOptions.isResolvedFromDuration = true;\n    }\n    return springOptions;\n}\nfunction spring(_a) {\n    var _b = _a.from, from = _b === void 0 ? 0.0 : _b, _c = _a.to, to = _c === void 0 ? 1.0 : _c, _d = _a.restSpeed, restSpeed = _d === void 0 ? 2 : _d, restDelta = _a.restDelta, options = __rest(_a, [\"from\", \"to\", \"restSpeed\", \"restDelta\"]);\n    var state = { done: false, value: from };\n    var _e = getSpringOptions(options), stiffness = _e.stiffness, damping = _e.damping, mass = _e.mass, velocity = _e.velocity, duration = _e.duration, isResolvedFromDuration = _e.isResolvedFromDuration;\n    var resolveSpring = zero;\n    var resolveVelocity = zero;\n    function createSpring() {\n        var initialVelocity = velocity ? -(velocity / 1000) : 0.0;\n        var initialDelta = to - from;\n        var dampingRatio = damping / (2 * Math.sqrt(stiffness * mass));\n        var undampedAngularFreq = Math.sqrt(stiffness / mass) / 1000;\n        restDelta !== null && restDelta !== void 0 ? restDelta : (restDelta = Math.abs(to - from) <= 1 ? 0.01 : 0.4);\n        if (dampingRatio < 1) {\n            var angularFreq_1 = calcAngularFreq(undampedAngularFreq, dampingRatio);\n            resolveSpring = function (t) {\n                var envelope = Math.exp(-dampingRatio * undampedAngularFreq * t);\n                return (to -\n                    envelope *\n                        (((initialVelocity +\n                            dampingRatio * undampedAngularFreq * initialDelta) /\n                            angularFreq_1) *\n                            Math.sin(angularFreq_1 * t) +\n                            initialDelta * Math.cos(angularFreq_1 * t)));\n            };\n            resolveVelocity = function (t) {\n                var envelope = Math.exp(-dampingRatio * undampedAngularFreq * t);\n                return (dampingRatio *\n                    undampedAngularFreq *\n                    envelope *\n                    ((Math.sin(angularFreq_1 * t) *\n                        (initialVelocity +\n                            dampingRatio *\n                                undampedAngularFreq *\n                                initialDelta)) /\n                        angularFreq_1 +\n                        initialDelta * Math.cos(angularFreq_1 * t)) -\n                    envelope *\n                        (Math.cos(angularFreq_1 * t) *\n                            (initialVelocity +\n                                dampingRatio *\n                                    undampedAngularFreq *\n                                    initialDelta) -\n                            angularFreq_1 *\n                                initialDelta *\n                                Math.sin(angularFreq_1 * t)));\n            };\n        }\n        else if (dampingRatio === 1) {\n            resolveSpring = function (t) {\n                return to -\n                    Math.exp(-undampedAngularFreq * t) *\n                        (initialDelta +\n                            (initialVelocity + undampedAngularFreq * initialDelta) *\n                                t);\n            };\n        }\n        else {\n            var dampedAngularFreq_1 = undampedAngularFreq * Math.sqrt(dampingRatio * dampingRatio - 1);\n            resolveSpring = function (t) {\n                var envelope = Math.exp(-dampingRatio * undampedAngularFreq * t);\n                var freqForT = Math.min(dampedAngularFreq_1 * t, 300);\n                return (to -\n                    (envelope *\n                        ((initialVelocity +\n                            dampingRatio * undampedAngularFreq * initialDelta) *\n                            Math.sinh(freqForT) +\n                            dampedAngularFreq_1 *\n                                initialDelta *\n                                Math.cosh(freqForT))) /\n                        dampedAngularFreq_1);\n            };\n        }\n    }\n    createSpring();\n    return {\n        next: function (t) {\n            var current = resolveSpring(t);\n            if (!isResolvedFromDuration) {\n                var currentVelocity = resolveVelocity(t) * 1000;\n                var isBelowVelocityThreshold = Math.abs(currentVelocity) <= restSpeed;\n                var isBelowDisplacementThreshold = Math.abs(to - current) <= restDelta;\n                state.done =\n                    isBelowVelocityThreshold && isBelowDisplacementThreshold;\n            }\n            else {\n                state.done = t >= duration;\n            }\n            state.value = state.done ? to : current;\n            return state;\n        },\n        flipTarget: function () {\n            var _a;\n            velocity = -velocity;\n            _a = [to, from], from = _a[0], to = _a[1];\n            createSpring();\n        },\n    };\n}\nspring.needsInterpolation = function (a, b) {\n    return typeof a === \"string\" || typeof b === \"string\";\n};\nvar zero = function (_t) { return 0; };\n\nexport { spring };\n"]},"metadata":{},"sourceType":"module"}
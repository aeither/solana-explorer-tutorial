{"ast":null,"code":"import { warning } from 'hey-listen';\nimport { clamp } from '../../utils/clamp.js';\nvar safeMin = 0.001;\nvar minDuration = 0.01;\nvar maxDuration = 10.0;\nvar minDamping = 0.05;\nvar maxDamping = 1;\n\nfunction findSpring(_a) {\n  var _b = _a.duration,\n      duration = _b === void 0 ? 800 : _b,\n      _c = _a.bounce,\n      bounce = _c === void 0 ? 0.25 : _c,\n      _d = _a.velocity,\n      velocity = _d === void 0 ? 0 : _d,\n      _e = _a.mass,\n      mass = _e === void 0 ? 1 : _e;\n  var envelope;\n  var derivative;\n  warning(duration <= maxDuration * 1000, \"Spring duration must be 10 seconds or less\");\n  var dampingRatio = 1 - bounce;\n  dampingRatio = clamp(minDamping, maxDamping, dampingRatio);\n  duration = clamp(minDuration, maxDuration, duration / 1000);\n\n  if (dampingRatio < 1) {\n    envelope = function envelope(undampedFreq) {\n      var exponentialDecay = undampedFreq * dampingRatio;\n      var delta = exponentialDecay * duration;\n      var a = exponentialDecay - velocity;\n      var b = calcAngularFreq(undampedFreq, dampingRatio);\n      var c = Math.exp(-delta);\n      return safeMin - a / b * c;\n    };\n\n    derivative = function derivative(undampedFreq) {\n      var exponentialDecay = undampedFreq * dampingRatio;\n      var delta = exponentialDecay * duration;\n      var d = delta * velocity + velocity;\n      var e = Math.pow(dampingRatio, 2) * Math.pow(undampedFreq, 2) * duration;\n      var f = Math.exp(-delta);\n      var g = calcAngularFreq(Math.pow(undampedFreq, 2), dampingRatio);\n      var factor = -envelope(undampedFreq) + safeMin > 0 ? -1 : 1;\n      return factor * ((d - e) * f) / g;\n    };\n  } else {\n    envelope = function envelope(undampedFreq) {\n      var a = Math.exp(-undampedFreq * duration);\n      var b = (undampedFreq - velocity) * duration + 1;\n      return -safeMin + a * b;\n    };\n\n    derivative = function derivative(undampedFreq) {\n      var a = Math.exp(-undampedFreq * duration);\n      var b = (velocity - undampedFreq) * (duration * duration);\n      return a * b;\n    };\n  }\n\n  var initialGuess = 5 / duration;\n  var undampedFreq = approximateRoot(envelope, derivative, initialGuess);\n  duration = duration * 1000;\n\n  if (isNaN(undampedFreq)) {\n    return {\n      stiffness: 100,\n      damping: 10,\n      duration: duration\n    };\n  } else {\n    var stiffness = Math.pow(undampedFreq, 2) * mass;\n    return {\n      stiffness: stiffness,\n      damping: dampingRatio * 2 * Math.sqrt(mass * stiffness),\n      duration: duration\n    };\n  }\n}\n\nvar rootIterations = 12;\n\nfunction approximateRoot(envelope, derivative, initialGuess) {\n  var result = initialGuess;\n\n  for (var i = 1; i < rootIterations; i++) {\n    result = result - envelope(result) / derivative(result);\n  }\n\n  return result;\n}\n\nfunction calcAngularFreq(undampedFreq, dampingRatio) {\n  return undampedFreq * Math.sqrt(1 - dampingRatio * dampingRatio);\n}\n\nexport { calcAngularFreq, findSpring, maxDamping, maxDuration, minDamping, minDuration };","map":{"version":3,"sources":["/Users/lin/Documents/Projects/solana-explorer-tutorial/node_modules/popmotion/dist/es/animations/utils/find-spring.js"],"names":["warning","clamp","safeMin","minDuration","maxDuration","minDamping","maxDamping","findSpring","_a","_b","duration","_c","bounce","_d","velocity","_e","mass","envelope","derivative","dampingRatio","undampedFreq","exponentialDecay","delta","a","b","calcAngularFreq","c","Math","exp","d","e","pow","f","g","factor","initialGuess","approximateRoot","isNaN","stiffness","damping","sqrt","rootIterations","result","i"],"mappings":"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","sourcesContent":["import { warning } from 'hey-listen';\nimport { clamp } from '../../utils/clamp.js';\n\nvar safeMin = 0.001;\nvar minDuration = 0.01;\nvar maxDuration = 10.0;\nvar minDamping = 0.05;\nvar maxDamping = 1;\nfunction findSpring(_a) {\n    var _b = _a.duration, duration = _b === void 0 ? 800 : _b, _c = _a.bounce, bounce = _c === void 0 ? 0.25 : _c, _d = _a.velocity, velocity = _d === void 0 ? 0 : _d, _e = _a.mass, mass = _e === void 0 ? 1 : _e;\n    var envelope;\n    var derivative;\n    warning(duration <= maxDuration * 1000, \"Spring duration must be 10 seconds or less\");\n    var dampingRatio = 1 - bounce;\n    dampingRatio = clamp(minDamping, maxDamping, dampingRatio);\n    duration = clamp(minDuration, maxDuration, duration / 1000);\n    if (dampingRatio < 1) {\n        envelope = function (undampedFreq) {\n            var exponentialDecay = undampedFreq * dampingRatio;\n            var delta = exponentialDecay * duration;\n            var a = exponentialDecay - velocity;\n            var b = calcAngularFreq(undampedFreq, dampingRatio);\n            var c = Math.exp(-delta);\n            return safeMin - (a / b) * c;\n        };\n        derivative = function (undampedFreq) {\n            var exponentialDecay = undampedFreq * dampingRatio;\n            var delta = exponentialDecay * duration;\n            var d = delta * velocity + velocity;\n            var e = Math.pow(dampingRatio, 2) * Math.pow(undampedFreq, 2) * duration;\n            var f = Math.exp(-delta);\n            var g = calcAngularFreq(Math.pow(undampedFreq, 2), dampingRatio);\n            var factor = -envelope(undampedFreq) + safeMin > 0 ? -1 : 1;\n            return (factor * ((d - e) * f)) / g;\n        };\n    }\n    else {\n        envelope = function (undampedFreq) {\n            var a = Math.exp(-undampedFreq * duration);\n            var b = (undampedFreq - velocity) * duration + 1;\n            return -safeMin + a * b;\n        };\n        derivative = function (undampedFreq) {\n            var a = Math.exp(-undampedFreq * duration);\n            var b = (velocity - undampedFreq) * (duration * duration);\n            return a * b;\n        };\n    }\n    var initialGuess = 5 / duration;\n    var undampedFreq = approximateRoot(envelope, derivative, initialGuess);\n    duration = duration * 1000;\n    if (isNaN(undampedFreq)) {\n        return {\n            stiffness: 100,\n            damping: 10,\n            duration: duration,\n        };\n    }\n    else {\n        var stiffness = Math.pow(undampedFreq, 2) * mass;\n        return {\n            stiffness: stiffness,\n            damping: dampingRatio * 2 * Math.sqrt(mass * stiffness),\n            duration: duration,\n        };\n    }\n}\nvar rootIterations = 12;\nfunction approximateRoot(envelope, derivative, initialGuess) {\n    var result = initialGuess;\n    for (var i = 1; i < rootIterations; i++) {\n        result = result - envelope(result) / derivative(result);\n    }\n    return result;\n}\nfunction calcAngularFreq(undampedFreq, dampingRatio) {\n    return undampedFreq * Math.sqrt(1 - dampingRatio * dampingRatio);\n}\n\nexport { calcAngularFreq, findSpring, maxDamping, maxDuration, minDamping, minDuration };\n"]},"metadata":{},"sourceType":"module"}
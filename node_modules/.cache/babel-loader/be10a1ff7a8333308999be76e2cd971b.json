{"ast":null,"code":"import _classCallCheck from \"/Users/lin/Documents/Projects/solana-explorer-tutorial/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nimport { sortNodes, isElement, getNextIndex, getPrevIndex } from \"./utils\";\n/**\n * @internal\n *\n * Class to manage descendants and their relative indices in the DOM.\n * It uses `node.compareDocumentPosition(...)` under the hood\n */\n\nexport var DescendantsManager = function DescendantsManager() {\n  var _this2 = this;\n\n  _classCallCheck(this, DescendantsManager);\n\n  var _this = this;\n\n  _defineProperty(this, \"descendants\", new Map());\n\n  _defineProperty(this, \"register\", function (nodeOrOptions) {\n    if (nodeOrOptions == null) return;\n\n    if (isElement(nodeOrOptions)) {\n      return _this2.registerNode(nodeOrOptions);\n    }\n\n    return function (node) {\n      _this2.registerNode(node, nodeOrOptions);\n    };\n  });\n\n  _defineProperty(this, \"unregister\", function (node) {\n    _this2.descendants.delete(node);\n\n    var sorted = sortNodes(Array.from(_this2.descendants.keys()));\n\n    _this2.assignIndex(sorted);\n  });\n\n  _defineProperty(this, \"destroy\", function () {\n    _this2.descendants.clear();\n  });\n\n  _defineProperty(this, \"assignIndex\", function (descendants) {\n    _this2.descendants.forEach(function (descendant) {\n      var index = descendants.indexOf(descendant.node);\n      descendant.index = index;\n      descendant.node.dataset.index = descendant.index.toString();\n    });\n  });\n\n  _defineProperty(this, \"count\", function () {\n    return _this2.descendants.size;\n  });\n\n  _defineProperty(this, \"enabledCount\", function () {\n    return _this2.enabledValues().length;\n  });\n\n  _defineProperty(this, \"values\", function () {\n    var values = Array.from(_this2.descendants.values());\n    return values.sort(function (a, b) {\n      return a.index - b.index;\n    });\n  });\n\n  _defineProperty(this, \"enabledValues\", function () {\n    return _this2.values().filter(function (descendant) {\n      return !descendant.disabled;\n    });\n  });\n\n  _defineProperty(this, \"item\", function (index) {\n    if (_this2.count() === 0) return undefined;\n    return _this2.values()[index];\n  });\n\n  _defineProperty(this, \"enabledItem\", function (index) {\n    if (_this2.enabledCount() === 0) return undefined;\n    return _this2.enabledValues()[index];\n  });\n\n  _defineProperty(this, \"first\", function () {\n    return _this2.item(0);\n  });\n\n  _defineProperty(this, \"firstEnabled\", function () {\n    return _this2.enabledItem(0);\n  });\n\n  _defineProperty(this, \"last\", function () {\n    return _this2.item(_this2.descendants.size - 1);\n  });\n\n  _defineProperty(this, \"lastEnabled\", function () {\n    var lastIndex = _this2.enabledValues().length - 1;\n    return _this2.enabledItem(lastIndex);\n  });\n\n  _defineProperty(this, \"indexOf\", function (node) {\n    var _this$descendants$get, _this$descendants$get2;\n\n    if (!node) return -1;\n    return (_this$descendants$get = (_this$descendants$get2 = _this2.descendants.get(node)) == null ? void 0 : _this$descendants$get2.index) != null ? _this$descendants$get : -1;\n  });\n\n  _defineProperty(this, \"enabledIndexOf\", function (node) {\n    if (node == null) return -1;\n    return _this2.enabledValues().findIndex(function (i) {\n      return i.node.isSameNode(node);\n    });\n  });\n\n  _defineProperty(this, \"next\", function (index, loop) {\n    if (loop === void 0) {\n      loop = true;\n    }\n\n    var next = getNextIndex(index, _this.count(), loop);\n    return _this.item(next);\n  });\n\n  _defineProperty(this, \"nextEnabled\", function (index, loop) {\n    if (loop === void 0) {\n      loop = true;\n    }\n\n    var item = _this.item(index);\n\n    if (!item) return;\n\n    var enabledIndex = _this.enabledIndexOf(item.node);\n\n    var nextEnabledIndex = getNextIndex(enabledIndex, _this.enabledCount(), loop);\n    return _this.enabledItem(nextEnabledIndex);\n  });\n\n  _defineProperty(this, \"prev\", function (index, loop) {\n    if (loop === void 0) {\n      loop = true;\n    }\n\n    var prev = getPrevIndex(index, _this.count() - 1, loop);\n    return _this.item(prev);\n  });\n\n  _defineProperty(this, \"prevEnabled\", function (index, loop) {\n    if (loop === void 0) {\n      loop = true;\n    }\n\n    var item = _this.item(index);\n\n    if (!item) return;\n\n    var enabledIndex = _this.enabledIndexOf(item.node);\n\n    var prevEnabledIndex = getPrevIndex(enabledIndex, _this.enabledCount() - 1, loop);\n    return _this.enabledItem(prevEnabledIndex);\n  });\n\n  _defineProperty(this, \"registerNode\", function (node, options) {\n    if (!node || _this2.descendants.has(node)) return;\n    var keys = Array.from(_this2.descendants.keys()).concat(node);\n    var sorted = sortNodes(keys);\n\n    if (options != null && options.disabled) {\n      options.disabled = !!options.disabled;\n    }\n\n    var descendant = _extends({\n      node: node,\n      index: -1\n    }, options);\n\n    _this2.descendants.set(node, descendant);\n\n    _this2.assignIndex(sorted);\n  });\n};","map":{"version":3,"sources":["../../src/descendant.ts"],"names":["nodeOrOptions","isElement","node","sorted","sortNodes","Array","descendants","descendant","index","values","a","b","lastIndex","i","loop","next","getNextIndex","item","enabledIndex","nextEnabledIndex","prev","getPrevIndex","prevEnabledIndex","keys","options"],"mappings":"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","sourcesContent":["import { sortNodes, isElement, getNextIndex, getPrevIndex } from \"./utils\"\n\nexport type DescendantOptions<T = {}> = T & {\n  /**\n   * If `true`, the item will be registered in all nodes map\n   * but omitted from enabled nodes map\n   */\n  disabled?: boolean\n  /**\n   * The id of the item\n   */\n  id?: string\n}\n\nexport type Descendant<T, K> = DescendantOptions<K> & {\n  /**\n   * DOM element of the item\n   */\n  node: T\n  /**\n   * index of item in all nodes map and enabled nodes map\n   */\n  index: number\n}\n\n/**\n * @internal\n *\n * Class to manage descendants and their relative indices in the DOM.\n * It uses `node.compareDocumentPosition(...)` under the hood\n */\nexport class DescendantsManager<\n  T extends HTMLElement,\n  K extends Record<string, any> = {}\n> {\n  private descendants = new Map<T, Descendant<T, K>>()\n\n  register = (nodeOrOptions: T | null | DescendantOptions<K>) => {\n    if (nodeOrOptions == null) return\n\n    if (isElement(nodeOrOptions)) {\n      return this.registerNode(nodeOrOptions)\n    }\n\n    return (node: T | null) => {\n      this.registerNode(node, nodeOrOptions)\n    }\n  }\n\n  unregister = (node: T) => {\n    this.descendants.delete(node)\n    const sorted = sortNodes(Array.from(this.descendants.keys()))\n    this.assignIndex(sorted)\n  }\n\n  destroy = () => {\n    this.descendants.clear()\n  }\n\n  private assignIndex = (descendants: Node[]) => {\n    this.descendants.forEach((descendant) => {\n      const index = descendants.indexOf(descendant.node)\n      descendant.index = index\n      descendant.node.dataset.index = descendant.index.toString()\n    })\n  }\n\n  count = () => this.descendants.size\n\n  enabledCount = () => this.enabledValues().length\n\n  values = () => {\n    const values = Array.from(this.descendants.values())\n    return values.sort((a, b) => a.index - b.index)\n  }\n\n  enabledValues = () => {\n    return this.values().filter((descendant) => !descendant.disabled)\n  }\n\n  item = (index: number) => {\n    if (this.count() === 0) return undefined\n    return this.values()[index]\n  }\n\n  enabledItem = (index: number) => {\n    if (this.enabledCount() === 0) return undefined\n    return this.enabledValues()[index]\n  }\n\n  first = () => this.item(0)\n\n  firstEnabled = () => this.enabledItem(0)\n\n  last = () => this.item(this.descendants.size - 1)\n\n  lastEnabled = () => {\n    const lastIndex = this.enabledValues().length - 1\n    return this.enabledItem(lastIndex)\n  }\n\n  indexOf = (node: T | null) => {\n    if (!node) return -1\n    return this.descendants.get(node)?.index ?? -1\n  }\n\n  enabledIndexOf = (node: T | null) => {\n    if (node == null) return -1\n    return this.enabledValues().findIndex((i) => i.node.isSameNode(node))\n  }\n\n  next = (index: number, loop = true) => {\n    const next = getNextIndex(index, this.count(), loop)\n    return this.item(next)\n  }\n\n  nextEnabled = (index: number, loop = true) => {\n    const item = this.item(index)\n    if (!item) return\n    const enabledIndex = this.enabledIndexOf(item.node)\n    const nextEnabledIndex = getNextIndex(\n      enabledIndex,\n      this.enabledCount(),\n      loop,\n    )\n    return this.enabledItem(nextEnabledIndex)\n  }\n\n  prev = (index: number, loop = true) => {\n    const prev = getPrevIndex(index, this.count() - 1, loop)\n    return this.item(prev)\n  }\n\n  prevEnabled = (index: number, loop = true) => {\n    const item = this.item(index)\n    if (!item) return\n    const enabledIndex = this.enabledIndexOf(item.node)\n    const prevEnabledIndex = getPrevIndex(\n      enabledIndex,\n      this.enabledCount() - 1,\n      loop,\n    )\n    return this.enabledItem(prevEnabledIndex)\n  }\n\n  private registerNode = (node: T | null, options?: DescendantOptions<K>) => {\n    if (!node || this.descendants.has(node)) return\n\n    const keys = Array.from(this.descendants.keys()).concat(node)\n    const sorted = sortNodes(keys)\n\n    if (options?.disabled) {\n      options.disabled = !!options.disabled\n    }\n\n    const descendant = { node, index: -1, ...options }\n\n    this.descendants.set(node, descendant as Descendant<T, K>)\n\n    this.assignIndex(sorted)\n  }\n}\n"]},"metadata":{},"sourceType":"module"}
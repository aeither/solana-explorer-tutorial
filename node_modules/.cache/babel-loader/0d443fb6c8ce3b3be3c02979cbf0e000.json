{"ast":null,"code":"import { useRef } from 'react';\nimport { isNodeOrChild } from './utils/is-node-or-child.js';\nimport { usePointerEvent, addPointerEvent } from '../events/use-pointer-event.js';\nimport { useUnmountEffect } from '../utils/use-unmount-effect.js';\nimport { pipe } from 'popmotion';\nimport { AnimationType } from '../render/utils/types.js';\nimport { isDragActive } from './drag/utils/lock.js';\n/**\n * @param handlers -\n * @internal\n */\n\nfunction useTapGesture(_a) {\n  var onTap = _a.onTap,\n      onTapStart = _a.onTapStart,\n      onTapCancel = _a.onTapCancel,\n      whileTap = _a.whileTap,\n      visualElement = _a.visualElement;\n  var hasPressListeners = onTap || onTapStart || onTapCancel || whileTap;\n  var isPressing = useRef(false);\n  var cancelPointerEndListeners = useRef(null);\n\n  function removePointerEndListener() {\n    var _a;\n\n    (_a = cancelPointerEndListeners.current) === null || _a === void 0 ? void 0 : _a.call(cancelPointerEndListeners);\n    cancelPointerEndListeners.current = null;\n  }\n\n  function checkPointerEnd() {\n    var _a;\n\n    removePointerEndListener();\n    isPressing.current = false;\n    (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(AnimationType.Tap, false);\n    return !isDragActive();\n  }\n\n  function onPointerUp(event, info) {\n    if (!checkPointerEnd()) return;\n    /**\n     * We only count this as a tap gesture if the event.target is the same\n     * as, or a child of, this component's element\n     */\n\n    !isNodeOrChild(visualElement.getInstance(), event.target) ? onTapCancel === null || onTapCancel === void 0 ? void 0 : onTapCancel(event, info) : onTap === null || onTap === void 0 ? void 0 : onTap(event, info);\n  }\n\n  function onPointerCancel(event, info) {\n    if (!checkPointerEnd()) return;\n    onTapCancel === null || onTapCancel === void 0 ? void 0 : onTapCancel(event, info);\n  }\n\n  function onPointerDown(event, info) {\n    var _a;\n\n    removePointerEndListener();\n    if (isPressing.current) return;\n    isPressing.current = true;\n    cancelPointerEndListeners.current = pipe(addPointerEvent(window, \"pointerup\", onPointerUp), addPointerEvent(window, \"pointercancel\", onPointerCancel));\n    onTapStart === null || onTapStart === void 0 ? void 0 : onTapStart(event, info);\n    (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(AnimationType.Tap, true);\n  }\n\n  usePointerEvent(visualElement, \"pointerdown\", hasPressListeners ? onPointerDown : undefined);\n  useUnmountEffect(removePointerEndListener);\n}\n\nexport { useTapGesture };","map":{"version":3,"sources":["/Users/lin/Documents/Projects/solana-explorer-tutorial/node_modules/framer-motion/dist/es/gestures/use-tap-gesture.js"],"names":["useRef","isNodeOrChild","usePointerEvent","addPointerEvent","useUnmountEffect","pipe","AnimationType","isDragActive","useTapGesture","_a","onTap","onTapStart","onTapCancel","whileTap","visualElement","hasPressListeners","isPressing","cancelPointerEndListeners","removePointerEndListener","current","call","checkPointerEnd","animationState","setActive","Tap","onPointerUp","event","info","getInstance","target","onPointerCancel","onPointerDown","window","undefined"],"mappings":"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","sourcesContent":["import { useRef } from 'react';\nimport { isNodeOrChild } from './utils/is-node-or-child.js';\nimport { usePointerEvent, addPointerEvent } from '../events/use-pointer-event.js';\nimport { useUnmountEffect } from '../utils/use-unmount-effect.js';\nimport { pipe } from 'popmotion';\nimport { AnimationType } from '../render/utils/types.js';\nimport { isDragActive } from './drag/utils/lock.js';\n\n/**\n * @param handlers -\n * @internal\n */\nfunction useTapGesture(_a) {\n    var onTap = _a.onTap, onTapStart = _a.onTapStart, onTapCancel = _a.onTapCancel, whileTap = _a.whileTap, visualElement = _a.visualElement;\n    var hasPressListeners = onTap || onTapStart || onTapCancel || whileTap;\n    var isPressing = useRef(false);\n    var cancelPointerEndListeners = useRef(null);\n    function removePointerEndListener() {\n        var _a;\n        (_a = cancelPointerEndListeners.current) === null || _a === void 0 ? void 0 : _a.call(cancelPointerEndListeners);\n        cancelPointerEndListeners.current = null;\n    }\n    function checkPointerEnd() {\n        var _a;\n        removePointerEndListener();\n        isPressing.current = false;\n        (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(AnimationType.Tap, false);\n        return !isDragActive();\n    }\n    function onPointerUp(event, info) {\n        if (!checkPointerEnd())\n            return;\n        /**\n         * We only count this as a tap gesture if the event.target is the same\n         * as, or a child of, this component's element\n         */\n        !isNodeOrChild(visualElement.getInstance(), event.target)\n            ? onTapCancel === null || onTapCancel === void 0 ? void 0 : onTapCancel(event, info)\n            : onTap === null || onTap === void 0 ? void 0 : onTap(event, info);\n    }\n    function onPointerCancel(event, info) {\n        if (!checkPointerEnd())\n            return;\n        onTapCancel === null || onTapCancel === void 0 ? void 0 : onTapCancel(event, info);\n    }\n    function onPointerDown(event, info) {\n        var _a;\n        removePointerEndListener();\n        if (isPressing.current)\n            return;\n        isPressing.current = true;\n        cancelPointerEndListeners.current = pipe(addPointerEvent(window, \"pointerup\", onPointerUp), addPointerEvent(window, \"pointercancel\", onPointerCancel));\n        onTapStart === null || onTapStart === void 0 ? void 0 : onTapStart(event, info);\n        (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(AnimationType.Tap, true);\n    }\n    usePointerEvent(visualElement, \"pointerdown\", hasPressListeners ? onPointerDown : undefined);\n    useUnmountEffect(removePointerEndListener);\n}\n\nexport { useTapGesture };\n"]},"metadata":{},"sourceType":"module"}